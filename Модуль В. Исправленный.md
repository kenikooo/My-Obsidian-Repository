Установка HOSTNAME:
```bash
# На srv1
hostnamectl set-hostname srv1-cod.cod.ssa2025; exec bash
# На srv2
hostnamectl set-hostname srv2-cod.cod.ssa2025; exec bash
# На srv3
hostnamectl set-hostname srv3-cod.cod.ssa2025; exec bash
# На srv4
hostnamectl set-hostname srv4-cod.cod.ssa2025; exec bash
```
Дополняем /etc/hosts, на всех узлах:
```bash
192.168.20.11 srv1-cod.cod.ssa2025 srv1-cod
192.168.20.12 srv2-cod.cod.ssa2025 srv2-cod
192.168.20.13 srv3-cod.cod.ssa2025 srv3-cod
192.168.20.14 srv4-cod.cod.ssa2025 srv4-cod
```
### Подготовка дисков и файловых систем
Создание файловых систем XFS (на всех узлах):
```bash
for dev in sdb sdc sdd; do
  mkfs.xfs -f -i size=512 -n size=8192 /dev/$dev
done
```
Создаем папки и настраиваем автоматическое монтирование в /etc/fstab:
```bash
> vim script.sh
Содержимое:
#!/bin/bash
NODE_ID=1
DRIVES=(sdb sdc sdd)

for i in ${!DRIVES[@]}; do
    DEV="/dev/${DRIVES[$i]}"
    MNT="/mnt/minio-data-node${NODE_ID}-$((i+1))"
    
    mkdir -p "$MNT"
    mkfs.xfs -f "$DEV"
    UUID=$(blkid -s UUID -o value "$DEV")
    
    if [ -n "$UUID" ]; then
        echo "UUID=$UUID $MNT xfs defaults,noatime 0 2" >> /etc/fstab
    fi
done
```
Монтируем и проверяем:
```bash
mount -a
df -h | grep minio
chown -R _minio:_minio /mnt/minio-data-node*
chmod -R 755 /mnt/minio-data-node*
```
### Установка MiniO (на всех узлах)
```bash
apt-get update && apt-get install minio minio-mc -y
```
Вносим изменения /etc/sysconfig/minio:
```bash
MINIO_VOLUMES="http://srv1-cod.cod.ssa2025/mnt/minio-data-node1-1 http://srv1-cod.cod.ssa2025/mnt/minio-data-node1-2 http://srv1-cod.cod.ssa2025/mnt/minio-data-node1-3 http://srv2-cod.cod.ssa2025/mnt/minio-data-node2-1 http://srv2-cod.cod.ssa2025/mnt/minio-data-node2-2 http://srv2-cod.cod.ssa2025/mnt/minio-data-node2-3 http://srv3-cod.cod.ssa2025/mnt/minio-data-node3-1 http://srv3-cod.cod.ssa2025/mnt/minio-data-node3-2 http://srv3-cod.cod.ssa2025/mnt/minio-data-node3-3 http://srv4-cod.cod.ssa2025/mnt/minio-data-node4-1 http://srv4-cod.cod.ssa2025/mnt/minio-data-node4-2 http://srv4-cod.cod.ssa2025/mnt/minio-data-node4-3" # Меняем на ссылку
MINIO_ADDRESS=":9000" # Неизменна
MINIO_CONSOLE_ADDRESS=":9001" # Убираем 127.0.0.1
MINIO_ROOT_USER=minioadmincluster
MINIO_ROOT_PASSWORD=P@ssw0rd2025
```
### Настройка TLS/Сертификатов
```bash
mkdir -p ~/minio-ca && cd ~/minio-ca

# Генерируем корневой ключ и сертификат
openssl genrsa -out ca.key 2048
openssl req -new -x509 -days 3650 -key ca.key -out ca.crt \
    -subj "/CN=SSA-Root-CA"
```

### Выпускаем сертификаты для всех узлов (с SRV1-COD)
```bash
for i in {1..4}; do
  NAME="srv$i-cod.cod.ssa2025"
  
  # Создаем ключ узла
  openssl genrsa -out $NAME.key 2048
  
  # Создаем CSR
  openssl req -new -key $NAME.key -out $NAME.csr \
      -subj "/CN=$NAME"
  
  # Подписываем сертификат
  openssl x509 -req -in $NAME.csr -CA ca.crt -CAkey ca.key \
      -CAcreateserial -out $NAME.crt -days 365 \
      -extfile <(echo "subjectAltName=DNS:$NAME")
done
```

Распределяем сертификаты по узлам:
```bash
# Создаем структуру каталогов на всех узлах
mkdir -p /etc/minio/certs/CAs
chown -R minio:minio /etc/minio/certs

# Копируем сертификаты с srv1-cod на все узлы
for node in srv2-cod srv3-cod srv4-cod; do
  scp ca.crt ${node}:/etc/minio/certs/CAs/public.crt
  scp ${node}.cod.ssa2025.crt ${node}:/etc/minio/certs/public.crt
  scp ${node}.cod.ssa2025.key ${node}:/etc/minio/certs/private.key
done

# Настройка сертификатов на srv1-cod
cp ca.crt /etc/minio/certs/CAs/public.crt
cp srv1-cod.cod.ssa2025.crt /etc/minio/certs/public.crt
cp srv1-cod.cod.ssa2025.key /etc/minio/certs/private.key
```
Устанавливаем права доступа (на всех узлах):
```bash
chown -R minio:minio /etc/minio/certs
chmod 600 /etc/minio/certs/private.key
chmod 644 /etc/minio/certs/public.crt /etc/minio/certs/CAs/public.crt
```